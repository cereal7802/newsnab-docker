--- 
services: 
  db: 
    container_name: database
    environment: 
      - MYSQL_ROOT_PASSWORD=newznab
      - MYSQL_DATABASE=newznab
      - MYSQL_USER=newznab
      - MYSQL_PASSWORD=newznab
    image: mariadb
    ports: 
      - "127.0.0.1:3306:3306"
    restart: unless-stopped
    volumes: 
      - "$PWD/mysqldata:/var/lib/mysql"
      - "$PWD/configs/newznab-mysqld.cnf:/etc/mysql/conf.d/newznab.cnf"
  webserver: 
    build: build/webserver
    container_name: webserver
    environment: 
      - "APACHE_RUN_USER www-data"
      - "APACHE_RUN_GROUP www-data"
      - "APACHE_LOG_DIR /var/log/apache2"
      - "APACHE_LOCK_DIR /var/lock/apache2"
      - "APACHE_PID_FILE /var/run/apache2.pid"
    ports: 
      - "80:80"
    restart: unless-stopped
    volumes: 
      - "$PWD/configs/newznab-php.ini:/etc/php/7.0/apache2/conf.d/999-newznab.ini"
      - "$PWD/configs/apache:/etc/apache2"
      - "$PWD/webdata/nzb:/var/www/newznab/nzbfiles"
      - "$PWD/webdata/covers:/var/www/newznab/www/covers"
      - "$PWD/logs:/var/www/newznab/logs/"
  memcached:
    image: memcached
    container_name: memcached
    expose:
      - "11211"
version: "2"
